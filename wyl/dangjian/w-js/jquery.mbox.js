var MBOX_ZINDEX_INIT=1e4;(function(jQuery){jQuery.mboxClose=function(id,cbfun){id=parseInt(id),isNaN(id)&&(id=0),id>0?(jQuery("div[id=Mbox_background][ids="+id+"]").remove(),jQuery("div[id=Mbox_main][ids="+id+"]").remove()):(jQuery("#Mbox_background").remove(),jQuery("#Mbox_main").remove()),typeof cbfun=="function"?cbfun():typeof cbfun!="undefined"&&eval(cbfun)}})(jQuery),function(jQuery){jQuery.mbox=function(options,cbfun){function createBg(){B=jQuery("<div id='Mbox_background' ids='"+_this._opt.id+"'></div>").hide().css({zIndex:bgZindex}).css({opacity:jQuery("div[id=Mbox_background]").length>0?0:_this._opt.bgOpacity}).dblclick(function(){closeBox(_this._opt.id)}).appendTo("body").fadeIn(333)}function createBox(){mbox_tpl=getBoxTpl(),C=jQuery(mbox_tpl).css({zIndex:bgZindex+2}).appendTo("body").fadeIn(333),_this._opt.width!=_options.width?jQuery("#Mbox_body").css({width:_this._opt.width,maxWidth:_this._opt.width}):jQuery("#Mbox_body").css({width:_options.width,maxWidth:_options.width}),_this._opt.height!=_options.height&&jQuery("#Mbox_body").css({height:_this._opt.height,maxHeight:_this._opt.height}),setPosition(),_this._opt.drag&&drag(),C.find("*[fun=cb]").click(function(){typeof _this._opt.callBack=="function"?_this._opt.callBack():typeof _this._opt.callBack!="undefined"&&eval(_this._opt.callBack)}),_this._opt.type!=="confirm"&&_this._opt.timeout&&(jQuery("#Mbox_title").html(_this._opt.title+" <span style='font-size:12px;color:#FFF;'>"+_this._opt.timeout/1e3+"秒后自动关闭</span>"),sen=sen?sen:_this._opt.timeout,jQuery("#Mbox_title").html(_this._opt.title+" <span style='font-size:12px;color:#FFF;'>"+sen/1e3+"秒后自动关闭</span>"),ZZ=setInterval(function(){sen-=1e3,sen<=0?jQuery("#Mbox_title").html(_this._opt.title+" <span style='font-size:12px;color:#F88;'>关闭中……</span>"):jQuery("#Mbox_title").html(_this._opt.title+" <span style='font-size:12px;color:#FFF;'>"+sen/1e3+"秒后自动关闭</span>")},1e3),setTimeout(function(){sen=null,clearInterval(ZZ),closeBox(_this._opt.id)},_this._opt.timeout+100)),typeof cbfun=="function"?cbfun():typeof cbfun!="undefined"&&eval(cbfun),C.find("*[act=Mbox_close][ids="+_this._opt.id+"]").click(function(){closeBox(_this._opt.id)})}function setPosition(){if(!C)return!1;var e=C.width(),t=calPosition(e);C.css({left:t[0]+"px",top:t[1]+"px"});var n=jQuery(document).height(),r=jQuery(window).height(),i=t[1]+C.height();n=Math.max(n,r,i),B.height(n).width(jQuery(window).width())}function calPosition(e){return l=(jQuery(window).width()-e)/2,l<1&&(l=0),t=jQuery(window).scrollTop()+jQuery(window).height()/4,t<1?t=0:t-50>0&&(t-=50),[l,t]}function getBoxTpl(){var templateReplaced="",leftp="{",rightp="}",strReplace;eval("var Mbox_Tpl = MboxTpl_"+_this._opt.type+"_"+_this._opt.boxtpl);for(var paramName in _this._opt)templateReplaced="/"+leftp+paramName+rightp+"/g",templateReplaced=eval(templateReplaced),strReplace=_this._opt[paramName],Mbox_Tpl=Mbox_Tpl.replace(templateReplaced,strReplace);return Mbox_Tpl}function drag(){function i(r){r=r?r:window.event;var i,s;n=!1,i=r.clientX-e,s=r.clientY-t,r.clientX-e<0?i=0:r.clientX-e>jQuery(window).width()-C.width()&&(i=jQuery(window).width()-C.width()),r.clientY-t<0?s=0:r.clientY-t>jQuery(document).height()-C.height()&&(s=jQuery(document).height()-C.height()),C.css({left:i,top:s})}function s(){C.css("opacity",1),jQuery(document).unbind("mousemove").unbind("mouseup").unbind("selectstart").css("userSelect","text")}var e,t,n,r=jQuery("#Mbox_header").css({cursor:"move"});r.mousedown(function(n){n=n?n:window.event,e=n.clientX-parseInt(C.css("left")),t=n.clientY-parseInt(C.css("top")),C.css("opacity",.8),jQuery(document).mousemove(i).mouseup(s).bind("selectstart",function(){return!1}).css("userSelect","none")})}function closeBox(e){sen=null,clearInterval(ZZ),B.fadeOut(333,function(){B.remove()}),C.fadeOut(333,function(){C.remove()})}var _options={id:MBOX_ZINDEX_INIT,title:"",type:"html",html:"",drag:!0,bgOpacity:.3,timeout:!1,boxtpl:"default",width:"400px",height:"300px",callBack:null},B,C,mbox_tpl,sen,ZZ,_this=this,bgZindex=MBOX_ZINDEX_INIT+10;return _this._opt=jQuery.extend(_options,options),_this._opt.type=="loading"&&(_this._opt.title="请稍候..."),createBg(),createBox(),jQuery(window).resize(function(){setPosition()}),MBOX_ZINDEX_INIT+=100,_this._opt.id}}(jQuery);var MboxTpl_Base_Header='<div id="Mbox_main"><table border="0" cellpadding="0" cellspacing="0"><tr><td id="Mbox_header"><div id="Mbox_title">{title}</div><div id="Mbox_close" ids="{id}" act="Mbox_close" title="关闭">×</div></td></tr><tr><td id="Mbox_body">',MboxTpl_Base_Footer='</td></tr><tr><td id="Mbox_footer"></td></tr></table></div>',MboxTpl_html_default=MboxTpl_Base_Header+"{html}"+MboxTpl_Base_Footer,MboxTpl_loading_default=MboxTpl_Base_Header+'<div id="Mbox_loading"></div>'+MboxTpl_Base_Footer,MboxTpl_ok_default=MboxTpl_Base_Header+'<div id="Mbox_ok" class="Mbox_o_body"><div id="Mbox_ok_header" class="Mbox_o_header">成功啦！</div><div class="Mbox_o_content">{html}</div><div id="Mbox_ok_footer" class="Mbox_o_footer"><input id="Mbox_enter_btn" class="Mbox_btn" type="button" value="确 定" fun="cb" act="Mbox_close" ids="{id}"/></div></div>'+MboxTpl_Base_Footer,MboxTpl_fail_default=MboxTpl_Base_Header+'<div id="Mbox_fail" class="Mbox_o_body"><div id="Mbox_fail_header" class="Mbox_o_header">失败啦！</div><div class="Mbox_o_content">{html}</div><div id="Mbox_fail_footer" class="Mbox_o_footer"><input id="Mbox_enter_btn" class="Mbox_btn" type="button" value="确 定" fun="cb" act="Mbox_close" ids="{id}"/></div></div>'+MboxTpl_Base_Footer,MboxTpl_confirm_default=MboxTpl_Base_Header+'<div id="Mbox_confirm" class="Mbox_o_body"><div id="Mbox_confirm_header" class="Mbox_o_header">确定吗？</div><div class="Mbox_o_content">{html}</div><div id="Mbox_confirm_footer" class="Mbox_o_footer"><input id="Mbox_enter_btn" class="Mbox_btn" type="button" value="确 定" fun="cb" act="Mbox_close" ids="{id}"/><input id="Mbox_cancle_btn" class="Mbox_btn" type="button" value="取 消" act="Mbox_close" ids="{id}"/></div></div>'+MboxTpl_Base_Footer,MboxTpl_warning_default=MboxTpl_Base_Header+'<div id="Mbox_warning" class="Mbox_o_body"><div id="Mbox_warning_header" class="Mbox_o_header">警告！</div><div class="Mbox_o_content">{html}</div><div id="Mbox_warning_footer" class="Mbox_o_footer"><input id="Mbox_enter_btn" class="Mbox_btn" type="button" value="确 定" fun="cb" act="Mbox_close" ids="{id}"/></div></div>'+MboxTpl_Base_Footer